(function(a,b,c,d){function g(b,c){this.$element=a(b);this.options=a.extend(true,{},f,c);this.cols=[];this.isRemoteData=false;this.init();this.listen()}var e="dragonGrid",f={ajax:a.extend(true,{},a.ajaxSettings,{data:{page:1,maxRows:10,orderBy:"",where:""}}),colDefaults:{field:null,header:null,sortable:true,sortDir:"asc"},cols:[],cssClass:"table table-striped",source:[]};g.prototype={init:function(){this.$element.addClass(this.options.cssClass);this.loadData(a.proxy(this.createGrid,this))},loadData:function(a){var b=this;if(b.options.source.length>0){a()}else{b.isRemoteData=true;b.loadRemoteData(function(c){b.options.source=c.data||c;a()})}},loadRemoteData:function(b){a.ajax({type:this.options.ajax.type,url:this.options.ajax.url,data:this.options.ajax.data,dataType:this.options.ajax.dataType,success:b})},createGrid:function(){this.defineCols();this.renderHeader();this.renderBody()},defineCols:function(){var b=this;if(!b.options.cols.length){for(var c in b.options.source[0]){b.options.cols.push({field:c})}}a(b.options.cols).each(function(){var c=this;c.header=this.header||b.toCamel(this.field);c=a.extend({},b.options.colDefaults,this);b.cols.push(c)})},renderHeader:function(){var b=this.$element.find("thead");if(b.length>0){b.empty()}else{b=a("<thead></thead>")}a.map(this.cols,function(c,d){var e;if(c.sortable){e=a('<th data-field="'+c.field+'"><a href="#">'+(c.header||c.field)+"</a>Â  <i></i></th>")}else{e=a('<th data-field="'+c.field+'">'+(c.header||c.field)+"</th>")}b.append(e)});this.$element.append(b)},renderBody:function(){var b=this;var c=this.$element.find("tbody");if(c.length>0){c.empty()}else{c=a("<tbody></tbody>")}a(b.options.source).each(function(d,e){var f=a('<tr id="'+(b.options.rowIdentifier?e[b.options.rowIdentifier]:"dragon-grid-row-"+d)+'"></tr>');a(b.cols).each(function(a,b){f.append("<td>"+e[b.field]+"</td>")});c.append(f)});b.$element.append(c)},sorter:function(a,b){var c=this;if(c.isRemoteData){c.options.ajax.data.orderBy=a+" "+b;c.loadRemoteData(function(a){c.options.source=a.data||a;c.renderBody()})}else{c.options.source.sort(c.localSorter(a,b));c.renderBody()}},localSorter:function(a,b){if(b=="desc"){return function(b,c){return b[a]>c[a]?-1:b[a]<c[a]?1:0}}else{return function(b,c){return b[a]<c[a]?-1:b[a]>c[a]?1:0}}},listen:function(){this.$element.on("click","thead th a",a.proxy(this.headerClick,this))},headerClick:function(b){b.preventDefault();var c=a(b.currentTarget).parent();if(c.attr("data-sort-dir")==="asc"){c.attr("data-sort-dir","desc");c.find("i").attr("class","icon-chevron-down")}else{c.attr("data-sort-dir","asc");c.find("i").attr("class","icon-chevron-up")}this.sorter(c.attr("data-field"),c.attr("data-sort-dir"))},toCamel:function(a){return a.replace(/(?:^|\s)\w/g,function(a){return a.toUpperCase()})}};a.fn[e]=function(b){return this.each(function(){if(!a.data(this,"plugin_"+e)){a.data(this,"plugin_"+e,new g(this,b))}})}})(jQuery,window,document)